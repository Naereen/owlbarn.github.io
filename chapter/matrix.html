
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Matrix Manipulation &#8212; Owl Numerical Library 0.3 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Broadcasting Operation" href="broadcast.html" />
    <link rel="prev" title="N-Dimensional Array" href="ndarray.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/owl_logo_4.png" alt="Logo"/>
    
  </a>
</p>











  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Matrix Manipulation</a><ul>
<li><a class="reference internal" href="#create-matrices">Create Matrices</a></li>
<li><a class="reference internal" href="#access-elements">Access Elements</a></li>
<li><a class="reference internal" href="#iterate-elements-rows-columns">Iterate Elements, Rows, Columns</a></li>
<li><a class="reference internal" href="#filter-examine-elements-rows-columns">Filter / Examine Elements, Rows, Columns</a></li>
<li><a class="reference internal" href="#compare-two-matrices">Compare Two Matrices</a></li>
<li><a class="reference internal" href="#matrix-arithmetics">Matrix Arithmetics</a></li>
<li><a class="reference internal" href="#save-load-matrices">Save &amp; Load Matrices</a></li>
<li><a class="reference internal" href="#other-operations">Other Operations</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Part II: Owl Numerical System</a><ul>
      <li>Previous: <a href="ndarray.html" title="previous chapter">N-Dimensional Array</a></li>
      <li>Next: <a href="broadcast.html" title="next chapter">Broadcasting Operation</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="matrix-manipulation">
<h1>Matrix Manipulation<a class="headerlink" href="#matrix-manipulation" title="Permalink to this headline">¶</a></h1>
<p>Owl supports eight kinds of matrices as below, all the elements in a matrix are (real/complex) numbers.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Dense.Matrix.S</span></code> : Dense matrices of single precision float numbers.</li>
<li><code class="docutils literal notranslate"><span class="pre">Dense.Matrix.D</span></code> : Dense matrices of double precision float numbers.</li>
<li><code class="docutils literal notranslate"><span class="pre">Dense.Matrix.C</span></code> : Dense matrices of single precision complex numbers.</li>
<li><code class="docutils literal notranslate"><span class="pre">Dense.Matrix.Z</span></code> : Dense matrices of double precision complex numbers.</li>
<li><code class="docutils literal notranslate"><span class="pre">Sparse.Matrix.S</span></code> : Sparse matrices of single precision float numbers.</li>
<li><code class="docutils literal notranslate"><span class="pre">Sparse.Matrix.D</span></code> : Sparse matrices of double precision float numbers.</li>
<li><code class="docutils literal notranslate"><span class="pre">Sparse.Matrix.C</span></code> : Sparse matrices of single precision complex numbers.</li>
<li><code class="docutils literal notranslate"><span class="pre">Sparse.Matrix.Z</span></code> : Sparse matrices of double precision complex numbers.</li>
</ul>
<p>There are many common functions shared by these eight modules, therefore I will use <code class="docutils literal notranslate"><span class="pre">Mat</span></code> module (which is an alias of <code class="docutils literal notranslate"><span class="pre">Dense.Matrix.D</span></code> module) in the following examples. These examples should be able to applied to other modules without too much changes, but note some modules do have its own specific functions such as <code class="docutils literal notranslate"><span class="pre">Dense.Matrix.Z.re</span></code>.</p>
<p>The following examples can be run directly in <code class="docutils literal notranslate"><span class="pre">utop</span></code>. I assume that you already loaded <code class="docutils literal notranslate"><span class="pre">owl</span></code> library and opened <code class="docutils literal notranslate"><span class="pre">Owl</span></code> module in <code class="docutils literal notranslate"><span class="pre">utop</span></code> by executing the following commands.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span><span class="n">require</span> <span class="s2">&quot;owl&quot;</span><span class="o">;;</span>
<span class="k">open</span> <span class="nc">Owl</span><span class="o">;;</span>
</pre></div>
</div>
<div class="section" id="create-matrices">
<h2>Create Matrices<a class="headerlink" href="#create-matrices" title="Permalink to this headline">¶</a></h2>
<p>There are multiple functions to help you in creating an initial matrix to start with.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">empty</span> <span class="mi">5</span> <span class="mi">5</span><span class="o">;;</span>        <span class="c">(* create a 5 x 5 matrix with initialising elements *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">create</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">2</span><span class="o">.;;</span>    <span class="c">(* create a 5 x 5 matrix and initialise all to 2. *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">zeros</span> <span class="mi">5</span> <span class="mi">5</span><span class="o">;;</span>        <span class="c">(* create a 5 x 5 matrix of all zeros *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">ones</span> <span class="mi">5</span> <span class="mi">5</span><span class="o">;;</span>         <span class="c">(* create a 5 x 5 matrix of all ones *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">eye</span> <span class="mi">5</span><span class="o">;;</span>            <span class="c">(* create a 5 x 5 identity matrix *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">uniform</span> <span class="mi">5</span> <span class="mi">5</span><span class="o">;</span>       <span class="c">(* create a 5 x 5 random matrix of uniform distribution *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">uniform_int</span> <span class="mi">5</span> <span class="mi">5</span><span class="o">;;</span>  <span class="c">(* create a 5 x 5 random integer matrix *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">sequential</span> <span class="mi">5</span> <span class="mi">5</span><span class="o">;;</span>   <span class="c">(* create a 5 x 5 matrix of sequential integers *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">semidef</span> <span class="mi">5</span><span class="o">;;</span>        <span class="c">(* create a 5 x 5 random semi-definite matrix *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">gaussian</span> <span class="mi">5</span> <span class="mi">5</span><span class="o">;;</span>     <span class="c">(* create a 5 x 5 random Gaussian matrix *)</span>
</pre></div>
</div>
<p>As you noticed, the last example is to create a random matrix where the elements follow a Gaussian distribution. What about creating another matrix where the element follow another distribution, e.g., <code class="docutils literal notranslate"><span class="pre">t-distribution</span></code>? Easy!</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">empty</span> <span class="mi">5</span> <span class="mi">5</span> <span class="o">|&gt;</span> <span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="nn">Stats</span><span class="p">.</span><span class="nn">Rnd</span><span class="p">.</span><span class="n">tdist</span> <span class="mi">1</span><span class="o">.));;</span>
</pre></div>
</div>
<p>So, what we did is first creating an empty <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">x</span> <span class="pre">5</span></code> matrix, then mapping each element to a random number following <code class="docutils literal notranslate"><span class="pre">t-distribution</span></code>. The example utilises Owl’s <code class="docutils literal notranslate"><span class="pre">Stats</span></code> module which I will introduce in another tutorial.</p>
<p>Alternatively, you can apply the infix <code class="docutils literal notranslate"><span class="pre">&#64;&#64;</span></code> defined in all four matrix module to have terser expression, as below.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="nn">Stats</span><span class="p">.</span><span class="nn">Rnd</span><span class="p">.</span><span class="n">tdist</span> <span class="o">@@</span> <span class="n">ones</span> <span class="mi">5</span> <span class="mi">5</span><span class="o">);;</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="nn">Stats</span><span class="p">.</span><span class="nn">Rnd</span><span class="p">.</span><span class="n">gamma</span> <span class="mi">1</span><span class="o">.</span> <span class="o">@@</span> <span class="n">ones</span> <span class="mi">5</span> <span class="mi">5</span><span class="o">);;</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="access-elements">
<h2>Access Elements<a class="headerlink" href="#access-elements" title="Permalink to this headline">¶</a></h2>
<p>All four matrix modules support <code class="docutils literal notranslate"><span class="pre">set</span></code> and <code class="docutils literal notranslate"><span class="pre">get</span></code> to access and modify matrix elements.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="nn">Mat</span><span class="p">.</span><span class="n">uniform_int</span> <span class="mi">5</span> <span class="mi">5</span><span class="o">;;</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">set</span> <span class="n">x</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">0</span><span class="o">.;;</span>             <span class="c">(* set the element at (1,2) to 0. *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">get</span> <span class="n">x</span> <span class="mi">0</span> <span class="mi">3</span><span class="o">;;</span>                <span class="c">(* get the value of the element at (0,3) *)</span>
</pre></div>
</div>
<p>For dense matrices, i.e., <code class="docutils literal notranslate"><span class="pre">Dense.Matrix.*</span></code>, you can also use shorthand <code class="docutils literal notranslate"><span class="pre">{i,j}</span></code> to access elements.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.{</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">}</span> <span class="o">&lt;-</span> <span class="mi">0</span><span class="o">.;;</span>         <span class="c">(* set the element at (1,2) to 0. *)</span>
<span class="k">let</span> <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="o">.{</span><span class="mi">0</span><span class="o">,</span><span class="mi">3</span><span class="o">};;</span>       <span class="c">(* get the value of the element at (0,3) *)</span>
</pre></div>
</div>
<p>The modifications to a matrix using <code class="docutils literal notranslate"><span class="pre">set</span></code> are in-place. This is always true for dense matrices. For sparse matrices, the thing can be complicated because of performance issues. I will discuss about sparse matrices separately in a separate post.</p>
</div>
<div class="section" id="iterate-elements-rows-columns">
<h2>Iterate Elements, Rows, Columns<a class="headerlink" href="#iterate-elements-rows-columns" title="Permalink to this headline">¶</a></h2>
<p>In reality, a matrix usually represents a collections of measurements (or points). We often need to go through these data again and again for various reasons. Owl provides very convenient functions to help you to iterate these elements. There is one thing I want to emphasise: Owl uses row-major matrix for storage format in the memory, which means accessing rows are much faster than those column operations.</p>
<p>Let’s first create a <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">x</span> <span class="pre">6</span></code> matrix of sequential numbers as below.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="nn">Mat</span><span class="p">.</span><span class="n">sequential</span> <span class="mi">4</span> <span class="mi">6</span><span class="o">;;</span>
</pre></div>
</div>
<p>You should be able to see the following output in your <code class="docutils literal notranslate"><span class="pre">utop</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span>   <span class="nc">C0</span> <span class="nc">C1</span> <span class="nc">C2</span> <span class="nc">C3</span> <span class="nc">C4</span> <span class="nc">C5</span>
<span class="nc">R0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>
<span class="nc">R1</span>  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span>
<span class="nc">R2</span> <span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="mi">16</span> <span class="mi">17</span> <span class="mi">18</span>
<span class="nc">R3</span> <span class="mi">19</span> <span class="mi">20</span> <span class="mi">21</span> <span class="mi">22</span> <span class="mi">23</span> <span class="mi">24</span>
</pre></div>
</div>
<p>Iterating all the elements can be done by using <code class="docutils literal notranslate"><span class="pre">iteri</span></code> function. The following example prints out all the elements on the screen.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">iteri</span> <span class="o">(</span><span class="k">fun</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;(%i,%i) %.1f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span><span class="o">)</span> <span class="n">x</span><span class="o">;;</span>
</pre></div>
</div>
<p>If you want to create a new matrix out of the existing one, you need <code class="docutils literal notranslate"><span class="pre">mapi</span></code> and <code class="docutils literal notranslate"><span class="pre">map</span></code> function. E.g., we create a new matrix by adding one to each element in <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">map</span> <span class="o">((+.)</span> <span class="mi">1</span><span class="o">.)</span> <span class="n">x</span><span class="o">;;</span>
</pre></div>
</div>
<p>We can take some rows out of <code class="docutils literal notranslate"><span class="pre">x</span></code> by calling <code class="docutils literal notranslate"><span class="pre">rows</span></code> function. The selected rows will be used to assemble a new matrix.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">rows</span> <span class="n">x</span> <span class="o">[|</span><span class="mi">0</span><span class="o">;</span><span class="mi">2</span><span class="o">|];;</span>
<span class="nc">R0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>
<span class="nc">R1</span> <span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="mi">16</span> <span class="mi">17</span> <span class="mi">18</span>
<span class="o">-</span> <span class="o">:</span> <span class="nn">Owl_dense_real</span><span class="p">.</span><span class="n">mat</span> <span class="o">=</span>
</pre></div>
</div>
<p>Similarly, we can also select some columns as below.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">cols</span> <span class="n">x</span> <span class="o">[|</span><span class="mi">3</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">|];;</span>
   <span class="nc">C0</span> <span class="nc">C1</span> <span class="nc">C2</span>
<span class="nc">R0</span>  <span class="mi">4</span>  <span class="mi">3</span>  <span class="mi">2</span>
<span class="nc">R1</span> <span class="mi">10</span>  <span class="mi">9</span>  <span class="mi">8</span>
<span class="nc">R2</span> <span class="mi">16</span> <span class="mi">15</span> <span class="mi">14</span>
<span class="nc">R3</span> <span class="mi">22</span> <span class="mi">21</span> <span class="mi">20</span>
<span class="o">-</span> <span class="o">:</span> <span class="nn">Owl_dense_real</span><span class="p">.</span><span class="n">mat</span> <span class="o">=</span>
</pre></div>
</div>
<p>Iterating rows and columns are similar to iterating elements, by using <code class="docutils literal notranslate"><span class="pre">iteri_rows</span></code>, <code class="docutils literal notranslate"><span class="pre">mapi_rows</span></code>, and etc. The following example prints the sum of each row.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">iteri_rows</span> <span class="o">(</span><span class="k">fun</span> <span class="n">i</span> <span class="n">r</span> <span class="o">-&gt;</span>
  <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;row %i: %.1f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">i</span> <span class="o">(</span><span class="nn">Mat</span><span class="p">.</span><span class="n">sum</span> <span class="n">r</span><span class="o">)</span>
<span class="o">)</span> <span class="n">x</span><span class="o">;;</span>
</pre></div>
</div>
<p>You can also fold elements, rows, and columns. Let’s first calculate the summation of all elements.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">fold</span> <span class="o">(+.)</span> <span class="mi">0</span><span class="o">.</span> <span class="n">x</span><span class="o">;;</span>
</pre></div>
</div>
<p>Now, we calculate the summation of all column vectors by using <code class="docutils literal notranslate"><span class="pre">fold_cols</span></code> fucntion.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">v</span> <span class="o">=</span> <span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">zeros</span> <span class="o">(</span><span class="n">row_num</span> <span class="n">x</span><span class="o">)</span> <span class="mi">1</span><span class="o">)</span> <span class="k">in</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">fold_cols</span> <span class="n">add</span> <span class="n">v</span> <span class="n">x</span><span class="o">);;</span>
</pre></div>
</div>
<p>It is also possible to change a specific row or column. E.g., we make a new matrix out of <code class="docutils literal notranslate"><span class="pre">x</span></code> by setting row <code class="docutils literal notranslate"><span class="pre">2</span></code> to zero vector.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">map_at_row</span> <span class="o">(</span><span class="k">fun</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="mi">0</span><span class="o">.)</span> <span class="n">x</span> <span class="mi">2</span><span class="o">;;</span>
</pre></div>
</div>
</div>
<div class="section" id="filter-examine-elements-rows-columns">
<h2>Filter / Examine Elements, Rows, Columns<a class="headerlink" href="#filter-examine-elements-rows-columns" title="Permalink to this headline">¶</a></h2>
<p>To continue use the previous sequential matrix, I will make some examples to show how to examine and filter elements in a matrix. The first one is to filter out the elements in <code class="docutils literal notranslate"><span class="pre">x</span></code> greater than <code class="docutils literal notranslate"><span class="pre">20</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">filter</span> <span class="o">((&lt;)</span> <span class="mi">20</span><span class="o">.)</span> <span class="n">x</span><span class="o">;;</span>
</pre></div>
</div>
<p>The second example is to filter out the rows whose summation is less than <code class="docutils literal notranslate"><span class="pre">22</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">filter_rows</span> <span class="o">(</span><span class="k">fun</span> <span class="n">r</span> <span class="o">-&gt;</span> <span class="nn">Mat</span><span class="p">.</span><span class="n">sum</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">22</span><span class="o">.)</span> <span class="n">x</span><span class="o">;;</span>
</pre></div>
</div>
<p>If we want to check whether there is one or (or all) element in <code class="docutils literal notranslate"><span class="pre">x</span></code> satisfying some condition, then</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">exists</span> <span class="o">((&gt;)</span> <span class="mi">5</span><span class="o">.)</span> <span class="n">x</span><span class="o">;;</span>      <span class="c">(* is there someone smaller than 5. *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">not_exists</span> <span class="o">((&gt;)</span> <span class="mi">5</span><span class="o">.)</span> <span class="n">x</span><span class="o">;;</span>  <span class="c">(* is no one smaller than 5. *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">for_all</span> <span class="o">((&gt;)</span> <span class="mi">5</span><span class="o">.)</span> <span class="n">x</span><span class="o">;;</span>     <span class="c">(* is everyone smaller than 5. *)</span>
</pre></div>
</div>
</div>
<div class="section" id="compare-two-matrices">
<h2>Compare Two Matrices<a class="headerlink" href="#compare-two-matrices" title="Permalink to this headline">¶</a></h2>
<p>Comparing two matrices is just so easy by using module infix <code class="docutils literal notranslate"><span class="pre">=&#64;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;&gt;&#64;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;&#64;</span></code>, and etc. Let’s first create another matrix <code class="docutils literal notranslate"><span class="pre">y</span></code> by multiplying two to every elements in <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">y</span> <span class="o">=</span> <span class="nn">Mat</span><span class="p">.</span><span class="n">map</span> <span class="o">((</span> <span class="o">*.</span> <span class="o">)</span> <span class="mi">2</span><span class="o">.)</span> <span class="n">x</span><span class="o">;;</span>
</pre></div>
</div>
<p>Then we can compare the relationship of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> as below. Note, the relationship is derived by checking every elements in both matrices. E.g., <code class="docutils literal notranslate"><span class="pre">x</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">y</span></code> means every element in <code class="docutils literal notranslate"><span class="pre">x</span></code> is equal the corresponding element in <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="o">);;</span>    <span class="c">(* is x equal to y *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">&lt;&gt;</span> <span class="n">y</span><span class="o">);;</span>   <span class="c">(* is x unequal to y *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="o">);;</span>    <span class="c">(* is x greater to y *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">);;</span>    <span class="c">(* is x smaller to y *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">y</span><span class="o">);;</span>   <span class="c">(* is x not smaller to y *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">y</span><span class="o">);;</span>   <span class="c">(* is x not greater to y *)</span>
</pre></div>
</div>
<p>All aforementioned infix have their corresponding functions in the module, e.g., <code class="docutils literal notranslate"><span class="pre">=&#64;</span></code> has <code class="docutils literal notranslate"><span class="pre">Mat.is_equal</span></code>. Please refer to the documentation.</p>
</div>
<div class="section" id="matrix-arithmetics">
<h2>Matrix Arithmetics<a class="headerlink" href="#matrix-arithmetics" title="Permalink to this headline">¶</a></h2>
<p>The arithmetic operation also heavily uses infix. Similar to matrix comparison, each infix has its corresponding function in the module.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">);;</span>    <span class="c">(* add two matrices *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="o">);;</span>    <span class="c">(* subtract y from x *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="o">);;</span>    <span class="c">(* element-wise multiplication *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">y</span><span class="o">);;</span>    <span class="c">(* element-wise division *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">*@</span> <span class="n">y</span><span class="o">);;</span>    <span class="c">(* dot product of x and y *)</span>
</pre></div>
</div>
<p>If you do match between a matrix and a scalar value, you need to be careful about their order. Please see the examples below. In the following examples, <code class="docutils literal notranslate"><span class="pre">x</span></code> is a matrix as we used before, and <code class="docutils literal notranslate"><span class="pre">a</span></code> is a <code class="docutils literal notranslate"><span class="pre">float</span></code> scalar value.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">+$</span> <span class="n">a</span><span class="o">);;</span>    <span class="c">(* add a to every element in x *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">a</span> <span class="o">$+</span> <span class="n">x</span><span class="o">);;</span>    <span class="c">(* add a to every element in x *)</span>
</pre></div>
</div>
<p>Similarly, we have the following examples for other math operations.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">-$</span> <span class="n">a</span><span class="o">);;</span>    <span class="c">(* sub a from every element in x *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">a</span> <span class="o">$-</span> <span class="n">x</span><span class="o">);;</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">*$</span> <span class="n">a</span><span class="o">);;</span>    <span class="c">(* mul a with every element in x *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">a</span> <span class="o">$*</span> <span class="n">x</span><span class="o">);;</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">/$</span> <span class="n">a</span><span class="o">);;</span>    <span class="c">(* div a to every element in x *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">a</span> <span class="o">$/</span> <span class="n">x</span><span class="o">);;</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">**</span> <span class="n">a</span><span class="o">);;</span>    <span class="c">(* power of every element in x *)</span>
</pre></div>
</div>
<p>There are some ready-made functions to ease your life when operating matrices.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">log10</span> <span class="n">x</span><span class="o">;;</span>     <span class="c">(* logarithm of every element in x *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">abs</span> <span class="n">x</span><span class="o">;;</span>       <span class="c">(* absolute value of every element in x *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">neg</span> <span class="n">x</span><span class="o">;;</span>       <span class="c">(* negation of every element in x *)</span>
<span class="o">...</span>
</pre></div>
</div>
<p>They are actually equivalent to</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="nn">Maths</span><span class="p">.</span><span class="n">log10</span> <span class="o">@@</span> <span class="n">x</span><span class="o">);;</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="nn">Maths</span><span class="p">.</span><span class="n">abs</span> <span class="o">@@</span> <span class="n">x</span><span class="o">);;</span>
<span class="o">...</span>
</pre></div>
</div>
<p>For more advanced operations such as <code class="docutils literal notranslate"><span class="pre">svd</span></code> and <code class="docutils literal notranslate"><span class="pre">qr</span></code> operations, you need to use <code class="docutils literal notranslate"><span class="pre">Linalg</span></code> module. Currently, <code class="docutils literal notranslate"><span class="pre">Linalg</span></code> only works on dense matrices of real numbers. I will provide more supports for other types of matrices in future.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Linalg</span><span class="p">.</span><span class="n">svd</span> <span class="n">x</span><span class="o">;;</span>  <span class="c">(* svd of x *)</span>
<span class="nn">Linalg</span><span class="p">.</span><span class="n">qr</span> <span class="n">x</span><span class="o">;;</span>   <span class="c">(* QR decomposition of x *)</span>
<span class="nn">Linalg</span><span class="p">.</span><span class="n">inv</span> <span class="n">x</span><span class="o">;;</span>  <span class="c">(* inverse of x *)</span>
<span class="nn">Linalg</span><span class="p">.</span><span class="n">det</span> <span class="n">x</span><span class="o">;;</span>  <span class="c">(* determinant of x *)</span>
</pre></div>
</div>
</div>
<div class="section" id="save-load-matrices">
<h2>Save &amp; Load Matrices<a class="headerlink" href="#save-load-matrices" title="Permalink to this headline">¶</a></h2>
<p>All matrices can be serialised to storage by using <code class="docutils literal notranslate"><span class="pre">save</span></code>. Later, you can load a matrix using <code class="docutils literal notranslate"><span class="pre">load</span></code> function.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="n">save</span> <span class="n">x</span> <span class="s2">&quot;m0.mat&quot;</span><span class="o">;;</span>    <span class="c">(* save x to m0.mat file *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="n">load</span> <span class="s2">&quot;m0.mat&quot;</span><span class="o">;;</span>      <span class="c">(* load m0.mat back to the memory *)</span>
</pre></div>
</div>
<p>I also made corresponding <code class="docutils literal notranslate"><span class="pre">save_txt</span></code> and <code class="docutils literal notranslate"><span class="pre">load_txt</span></code> functions for a simple tab-delimited, human-readable format. Note the performance is much worse than the corresponding <code class="docutils literal notranslate"><span class="pre">save</span></code> and <code class="docutils literal notranslate"><span class="pre">load</span></code>.</p>
</div>
<div class="section" id="other-operations">
<h2>Other Operations<a class="headerlink" href="#other-operations" title="Permalink to this headline">¶</a></h2>
<p>I will use another set of examples to finish this tutorial. I must say this tutorial has not presented all the operations provided by Owl’s matrix modules. There are much more operations you can explore by reading its documents.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">@=</span> <span class="n">y</span><span class="o">);;</span>    <span class="c">(* concatenate x and y vertically *)</span>
<span class="nn">Mat</span><span class="p">.</span><span class="o">(</span><span class="n">x</span> <span class="o">@||</span> <span class="n">y</span><span class="o">);;</span>   <span class="c">(* concatenate x and y horizontally *)</span>
</pre></div>
</div>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Sparse</span><span class="p">.</span><span class="nn">Real</span><span class="p">.</span><span class="n">map_nz</span> <span class="o">((+.)</span> <span class="mi">1</span><span class="o">.)</span> <span class="n">x</span><span class="o">;;</span>    <span class="c">(* add one to non-zero elements in a sparse matrix *)</span>
<span class="nn">Sparse</span><span class="p">.</span><span class="nn">Real</span><span class="p">.</span><span class="n">density</span> <span class="n">x</span><span class="o">;;</span>             <span class="c">(* show the density of a sparse matrix *)</span>
</pre></div>
</div>
<p>Enjoy Owl and happy coding!</p>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>

    <div class="footer">
      &copy;2018, <a href="http://www.cl.cam.ac.uk/~lw525/">Liang Wang</a>   | <a href="http://www.cl.cam.ac.uk/">Computer Lab, University of Cambridge</a>.
      
      |
      <a href="../_sources/chapter/matrix.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123353217-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123353217-1');
</script>

  </body>
</html>