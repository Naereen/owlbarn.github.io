
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Optimise.Generic Functor &#8212; Owl Numerical Library 0.3 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Regression.Generic Functor" href="owl_regression_generic.html" />
    <link rel="prev" title="Algodiff.Generic Functor" href="owl_algodiff_generic_sig.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/owl_logo_4.png" alt="Logo"/>
    
  </a>
</p>











  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Optimise.Generic Functor</a><ul>
<li><a class="reference internal" href="#utils-module">Utils module</a></li>
<li><a class="reference internal" href="#learning-rate-module">Learning_Rate module</a></li>
<li><a class="reference internal" href="#batch-module">Batch module</a></li>
<li><a class="reference internal" href="#loss-module">Loss module</a></li>
<li><a class="reference internal" href="#gradient-module">Gradient module</a></li>
<li><a class="reference internal" href="#momentum-module">Momentum module</a></li>
<li><a class="reference internal" href="#regularisation-module">Regularisation module</a></li>
<li><a class="reference internal" href="#clipping-module">Clipping module</a></li>
<li><a class="reference internal" href="#stopping-module">Stopping module</a></li>
<li><a class="reference internal" href="#checkpoint-module">Checkpoint module</a></li>
<li><a class="reference internal" href="#params-module">Params module</a></li>
<li><a class="reference internal" href="#core-functions">Core functions</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Owl’s API Reference</a><ul>
      <li>Previous: <a href="owl_algodiff_generic_sig.html" title="previous chapter">Algodiff.Generic Functor</a></li>
      <li>Next: <a href="owl_regression_generic.html" title="next chapter">Regression.Generic Functor</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="optimise-generic-functor">
<h1>Optimise.Generic Functor<a class="headerlink" href="#optimise-generic-functor" title="Permalink to this headline">¶</a></h1>
<p>This document is auto-generated for Owl’s APIs.
#60 entries have been extracted.
timestamp: 2018-04-16 15:44:52</p>
<p>Github:
<a class="reference external" href="https://github.com/ryanrhymes/owl/tree/master/src/base/optimise/owl_optimise_generic_sig.ml">{Signature}</a>
<a class="reference external" href="https://github.com/ryanrhymes/owl/tree/master/src/base/optimise/owl_optimise_generic.ml">{Implementation}</a></p>
<div class="section" id="utils-module">
<h2>Utils module<a class="headerlink" href="#utils-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">sample_num</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
</pre></div>
</div>
<p>Return the total number of samples in passed in ndarray.</p>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L31">source code</a></p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">draw_samples</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">*</span> <span class="n">t</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">draw_samples</span> <span class="pre">x</span> <span class="pre">y</span></code> draws samples from both <code class="docutils literal notranslate"><span class="pre">x</span></code> (observations) and <code class="docutils literal notranslate"><span class="pre">y</span></code>
(labels). The samples will be drew along axis 0, so <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> must agree
along axis 0.</p>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L36">source code</a></p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">get_chunk</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">*</span> <span class="n">t</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">get_chunk</span> <span class="pre">x</span> <span class="pre">y</span> <span class="pre">i</span> <span class="pre">c</span></code> gets a continuous chunk of <code class="docutils literal notranslate"><span class="pre">c</span></code> samples from position
<code class="docutils literal notranslate"><span class="pre">i</span></code> from  <code class="docutils literal notranslate"><span class="pre">x</span></code> (observations) and <code class="docutils literal notranslate"><span class="pre">y</span></code> (labels).</p>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L45">source code</a></p>
</div>
<div class="section" id="learning-rate-module">
<h2>Learning_Rate module<a class="headerlink" href="#learning-rate-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">typ</span> <span class="o">=</span>
  <span class="o">|</span> <span class="nc">Adagrad</span> <span class="k">of</span> <span class="kt">float</span>
  <span class="o">|</span> <span class="nc">Const</span> <span class="k">of</span> <span class="kt">float</span>
  <span class="o">|</span> <span class="nc">Decay</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span>
  <span class="o">|</span> <span class="nc">Exp_decay</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span>
  <span class="o">|</span> <span class="nc">RMSprop</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span>
  <span class="o">|</span> <span class="nc">Adam</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span>
  <span class="o">|</span> <span class="nc">Schedule</span> <span class="k">of</span> <span class="kt">float</span> <span class="kt">array</span>
</pre></div>
</div>
<p>types of learning rate</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">run</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="kt">array</span> <span class="o">-&gt;</span> <span class="n">t</span>
</pre></div>
</div>
<p>Execute the computations defined in module <code class="docutils literal notranslate"><span class="pre">typ</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">default</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="n">typ</span>
</pre></div>
</div>
<p>Create module <code class="docutils literal notranslate"><span class="pre">typ</span></code> with default values.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">update_ch</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="kt">array</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="kt">array</span>
</pre></div>
</div>
<p>Update the cache of gradients.</p>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L93">source code</a></p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">to_string</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</pre></div>
</div>
<p>Convert the module <code class="docutils literal notranslate"><span class="pre">typ</span></code> to its string representation.</p>
</div>
<div class="section" id="batch-module">
<h2>Batch module<a class="headerlink" href="#batch-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">typ</span> <span class="o">=</span> <span class="nc">Full</span> <span class="o">|</span> <span class="nc">Mini</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="nc">Sample</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="nc">Stochastic</span>
</pre></div>
</div>
<p>Types of batches.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">run</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">*</span> <span class="n">t</span>
</pre></div>
</div>
<p>Execute the computations defined in module <code class="docutils literal notranslate"><span class="pre">typ</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">batches</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
</pre></div>
</div>
<p>Return the total number of batches given a batch <code class="docutils literal notranslate"><span class="pre">typ</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">to_string</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</pre></div>
</div>
<p>Convert the module <code class="docutils literal notranslate"><span class="pre">typ</span></code> to its string representation.</p>
</div>
<div class="section" id="loss-module">
<h2>Loss module<a class="headerlink" href="#loss-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">typ</span> <span class="o">=</span>
  <span class="o">|</span> <span class="nc">Hinge</span>
  <span class="o">|</span> <span class="nc">L1norm</span>
  <span class="o">|</span> <span class="nc">L2norm</span>
  <span class="o">|</span> <span class="nc">Quadratic</span>
  <span class="o">|</span> <span class="nc">Cross_entropy</span>
  <span class="o">|</span> <span class="nc">Custom</span> <span class="k">of</span> <span class="o">(</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">)</span>
</pre></div>
</div>
<p>Types of loss functions.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">run</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span>
</pre></div>
</div>
<p>Execute the computations defined in module <code class="docutils literal notranslate"><span class="pre">typ</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">to_string</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</pre></div>
</div>
<p>Convert the module <code class="docutils literal notranslate"><span class="pre">typ</span></code> to its string representation.</p>
</div>
<div class="section" id="gradient-module">
<h2>Gradient module<a class="headerlink" href="#gradient-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">typ</span> <span class="o">=</span> <span class="nc">GD</span> <span class="o">|</span> <span class="nc">CG</span> <span class="o">|</span> <span class="nc">CD</span> <span class="o">|</span> <span class="nc">NonlinearCG</span> <span class="o">|</span> <span class="nc">DaiYuanCG</span> <span class="o">|</span> <span class="nc">NewtonCG</span> <span class="o">|</span> <span class="nc">Newton</span>
</pre></div>
</div>
<p>Types of gradient function.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">run</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span>
</pre></div>
</div>
<p>Execute the computations defined in module <code class="docutils literal notranslate"><span class="pre">typ</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">to_string</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</pre></div>
</div>
<p>Convert the module <code class="docutils literal notranslate"><span class="pre">typ</span></code> to its string representation.</p>
</div>
<div class="section" id="momentum-module">
<h2>Momentum module<a class="headerlink" href="#momentum-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">typ</span> <span class="o">=</span> <span class="nc">Standard</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="nc">Nesterov</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="nc">None</span>
</pre></div>
</div>
<p>Types of momentum functions.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">run</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span>
</pre></div>
</div>
<p>Execute the computations defined in module <code class="docutils literal notranslate"><span class="pre">typ</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">default</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="n">typ</span>
</pre></div>
</div>
<p>Create module <code class="docutils literal notranslate"><span class="pre">typ</span></code> with default values.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">to_string</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</pre></div>
</div>
<p>Convert the module <code class="docutils literal notranslate"><span class="pre">typ</span></code> to its string representation.</p>
</div>
<div class="section" id="regularisation-module">
<h2>Regularisation module<a class="headerlink" href="#regularisation-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">typ</span> <span class="o">=</span>
  <span class="o">|</span> <span class="nc">L1norm</span> <span class="k">of</span> <span class="kt">float</span>
  <span class="o">|</span> <span class="nc">L2norm</span> <span class="k">of</span> <span class="kt">float</span>
  <span class="o">|</span> <span class="nc">Elastic_net</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span>
  <span class="o">|</span> <span class="nc">None</span>
</pre></div>
</div>
<p>Types of regularisation functions.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">run</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span>
</pre></div>
</div>
<p>Execute the computations defined in module <code class="docutils literal notranslate"><span class="pre">typ</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">to_string</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</pre></div>
</div>
<p>Convert the module <code class="docutils literal notranslate"><span class="pre">typ</span></code> to its string representation.</p>
</div>
<div class="section" id="clipping-module">
<h2>Clipping module<a class="headerlink" href="#clipping-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">typ</span> <span class="o">=</span> <span class="nc">L2norm</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="nc">Value</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">|</span> <span class="nc">None</span>
</pre></div>
</div>
<p>Types of clipping functions.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">run</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span>
</pre></div>
</div>
<p>Execute the computations defined in module <code class="docutils literal notranslate"><span class="pre">typ</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">default</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="n">typ</span>
</pre></div>
</div>
<p>Create module <code class="docutils literal notranslate"><span class="pre">typ</span></code> with default values.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">to_string</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</pre></div>
</div>
<p>Convert the module <code class="docutils literal notranslate"><span class="pre">typ</span></code> to its string representation.</p>
</div>
<div class="section" id="stopping-module">
<h2>Stopping module<a class="headerlink" href="#stopping-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">typ</span> <span class="o">=</span> <span class="nc">Const</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="nc">Early</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">|</span> <span class="nc">None</span>
</pre></div>
</div>
<p>Types of stopping functions.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">run</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">float</span> <span class="o">-&gt;</span> <span class="kt">bool</span>
</pre></div>
</div>
<p>Execute the computations defined in module <code class="docutils literal notranslate"><span class="pre">typ</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">default</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="n">typ</span>
</pre></div>
</div>
<p>Create module <code class="docutils literal notranslate"><span class="pre">typ</span></code> with default values.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">to_string</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</pre></div>
</div>
<p>Convert the module <code class="docutils literal notranslate"><span class="pre">typ</span></code> to its string representation.</p>
</div>
<div class="section" id="checkpoint-module">
<h2>Checkpoint module<a class="headerlink" href="#checkpoint-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">state</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">mutable</span> <span class="n">current_batch</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">batches_per_epoch</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">epochs</span> <span class="o">:</span> <span class="kt">float</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">batches</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">loss</span> <span class="o">:</span> <span class="n">t</span> <span class="kt">array</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">start_at</span> <span class="o">:</span> <span class="kt">float</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">stop</span> <span class="o">:</span> <span class="kt">bool</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">gs</span> <span class="o">:</span> <span class="n">t</span> <span class="kt">array</span> <span class="kt">array</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">ps</span> <span class="o">:</span> <span class="n">t</span> <span class="kt">array</span> <span class="kt">array</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">us</span> <span class="o">:</span> <span class="n">t</span> <span class="kt">array</span> <span class="kt">array</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">ch</span> <span class="o">:</span> <span class="n">t</span> <span class="kt">array</span> <span class="kt">array</span> <span class="kt">array</span><span class="o">;</span>
  <span class="o">}</span>
</pre></div>
</div>
<p>Type definition of checkpoint</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">typ</span> <span class="o">=</span>
  <span class="o">|</span> <span class="nc">Batch</span> <span class="k">of</span> <span class="kt">int</span>
  <span class="o">|</span> <span class="nc">Epoch</span> <span class="k">of</span> <span class="kt">float</span>
  <span class="o">|</span> <span class="nc">Custom</span> <span class="k">of</span> <span class="o">(</span><span class="n">state</span> <span class="o">-&gt;</span> <span class="kt">unit</span><span class="o">)</span>
  <span class="o">|</span> <span class="nc">None</span>
</pre></div>
</div>
<p>Batch type.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">init_state</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">float</span> <span class="o">-&gt;</span> <span class="n">state</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">init_state</span> <span class="pre">batches_per_epoch</span> <span class="pre">epochs</span></code> initialises a state by specifying the
number of batches per epoch and the number of epochs in total.</p>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L346">source code</a></p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">default_checkpoint_fun</span> <span class="o">:</span> <span class="o">(</span><span class="kt">string</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span>
</pre></div>
</div>
<p>This function is used for saving intermediate files during optimisation.</p>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L362">source code</a></p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">print_state_info</span> <span class="o">:</span> <span class="n">state</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</pre></div>
</div>
<p>Print out the detail information of current <code class="docutils literal notranslate"><span class="pre">state</span></code>.</p>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L369">source code</a></p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">print_summary</span> <span class="o">:</span> <span class="n">state</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</pre></div>
</div>
<p>Print out the summary of current <code class="docutils literal notranslate"><span class="pre">state</span></code>.</p>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L382">source code</a></p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">run</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">string</span> <span class="o">-&gt;</span> <span class="kt">unit</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">state</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</pre></div>
</div>
<p>Execute the computations defined in module <code class="docutils literal notranslate"><span class="pre">typ</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">to_string</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</pre></div>
</div>
<p>Convert the module <code class="docutils literal notranslate"><span class="pre">typ</span></code> to its string representation.</p>
</div>
<div class="section" id="params-module">
<h2>Params module<a class="headerlink" href="#params-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">typ</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">mutable</span> <span class="n">epochs</span> <span class="o">:</span> <span class="kt">float</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">batch</span> <span class="o">:</span> <span class="nn">Batch</span><span class="p">.</span><span class="n">typ</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">gradient</span> <span class="o">:</span> <span class="nn">Gradient</span><span class="p">.</span><span class="n">typ</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">loss</span> <span class="o">:</span> <span class="nn">Loss</span><span class="p">.</span><span class="n">typ</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">learning_rate</span> <span class="o">:</span> <span class="nn">Learning_Rate</span><span class="p">.</span><span class="n">typ</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">regularisation</span> <span class="o">:</span> <span class="nn">Regularisation</span><span class="p">.</span><span class="n">typ</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">momentum</span> <span class="o">:</span> <span class="nn">Momentum</span><span class="p">.</span><span class="n">typ</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">clipping</span> <span class="o">:</span> <span class="nn">Clipping</span><span class="p">.</span><span class="n">typ</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">stopping</span> <span class="o">:</span> <span class="nn">Stopping</span><span class="p">.</span><span class="n">typ</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">checkpoint</span> <span class="o">:</span> <span class="nn">Checkpoint</span><span class="p">.</span><span class="n">typ</span><span class="o">;</span>
  <span class="k">mutable</span> <span class="n">verbosity</span> <span class="o">:</span> <span class="kt">bool</span><span class="o">;</span>
  <span class="o">}</span>
</pre></div>
</div>
<p>Type definition of paramater.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">default</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">-&gt;</span> <span class="n">typ</span>
</pre></div>
</div>
<p>Create module <code class="docutils literal notranslate"><span class="pre">typ</span></code> with default values.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">config</span> <span class="o">:</span> <span class="o">?</span><span class="n">batch</span><span class="o">:</span><span class="nn">Batch</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">?</span><span class="n">gradient</span><span class="o">:</span><span class="nn">Gradient</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">?</span><span class="n">loss</span><span class="o">:</span><span class="nn">Loss</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">?</span><span class="n">learning_rate</span><span class="o">:</span><span class="nn">Learning_Rate</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">?</span><span class="n">regularisation</span><span class="o">:</span><span class="nn">Regularisation</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">?</span><span class="n">momentum</span><span class="o">:</span><span class="nn">Momentum</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">?</span><span class="n">clipping</span><span class="o">:</span><span class="nn">Clipping</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">?</span><span class="n">stopping</span><span class="o">:</span><span class="nn">Stopping</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">?</span><span class="n">checkpoint</span><span class="o">:</span><span class="nn">Checkpoint</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">?</span><span class="n">verbosity</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span> <span class="kt">float</span> <span class="o">-&gt;</span> <span class="n">typ</span>
</pre></div>
</div>
<p>This function creates a parameter object with many configurations.</p>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L441">source code</a></p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">to_string</span> <span class="o">:</span> <span class="n">typ</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</pre></div>
</div>
<p>Convert the module <code class="docutils literal notranslate"><span class="pre">typ</span></code> to its string representation.</p>
</div>
<div class="section" id="core-functions">
<h2>Core functions<a class="headerlink" href="#core-functions" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">minimise_weight</span> <span class="o">:</span> <span class="o">?</span><span class="n">state</span><span class="o">:</span><span class="nn">Checkpoint</span><span class="p">.</span><span class="n">state</span> <span class="o">-&gt;</span> <span class="nn">Params</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Checkpoint</span><span class="p">.</span><span class="n">state</span> <span class="o">*</span> <span class="n">t</span>
</pre></div>
</div>
<p>This function minimises the weight <code class="docutils literal notranslate"><span class="pre">w</span></code> of passed-in function <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">f</span></code> is a function <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">:</span> <span class="pre">w</span> <span class="pre">-&gt;</span> <span class="pre">x</span> <span class="pre">-&gt;</span> <span class="pre">y</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">w</span></code> is a row vector but <code class="docutils literal notranslate"><span class="pre">y</span></code> can have any shape.</li>
</ul>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L482">source code</a></p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">minimise_network</span> <span class="o">:</span> <span class="o">?</span><span class="n">state</span><span class="o">:</span><span class="nn">Checkpoint</span><span class="p">.</span><span class="n">state</span> <span class="o">-&gt;</span> <span class="nn">Params</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">*</span> <span class="n">t</span> <span class="kt">array</span> <span class="kt">array</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="kt">array</span> <span class="kt">array</span> <span class="o">*</span> <span class="n">t</span> <span class="kt">array</span> <span class="kt">array</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">t</span> <span class="kt">array</span> <span class="kt">array</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">string</span> <span class="o">-&gt;</span> <span class="kt">unit</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Checkpoint</span><span class="p">.</span><span class="n">state</span>
</pre></div>
</div>
<p>This function is specifically designed for minimising the weights in a neural
network of graph structure. In Owl’s earlier versions, the functions in the
regression module were actually implemented using this function.</p>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L568">source code</a></p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">minimise_fun</span> <span class="o">:</span> <span class="o">?</span><span class="n">state</span><span class="o">:</span><span class="nn">Checkpoint</span><span class="p">.</span><span class="n">state</span> <span class="o">-&gt;</span> <span class="nn">Params</span><span class="p">.</span><span class="n">typ</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Checkpoint</span><span class="p">.</span><span class="n">state</span> <span class="o">*</span> <span class="n">t</span>
</pre></div>
</div>
<p>This function minimises <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">:</span> <span class="pre">x</span> <span class="pre">-&gt;</span> <span class="pre">y</span></code> w.r.t <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code> is an ndarray; and <code class="docutils literal notranslate"><span class="pre">y</span></code> is an scalar value.</p>
<p><a class="reference external" href="https://github.com/ryanrhymes/owl/blob/master/src/base/optimise/owl_optimise_generic.ml#L665">source code</a></p>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018, <a href="http://www.cl.cam.ac.uk/~lw525/">Liang Wang</a>   | <a href="http://www.cl.cam.ac.uk/">Computer Lab, University of Cambridge</a>.
      
      |
      <a href="../_sources/apidoc/owl_optimise_generic_sig.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>